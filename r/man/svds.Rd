% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/matrix.R
\name{svds}
\alias{svds}
\title{Calculate svds}
\usage{
svds(A, k, nu = k, nv = k, opts = list(), threads = 0L, ...)
}
\arguments{
\item{A}{The matrix whose truncated SVD is to be computed.}

\item{k}{Number of singular values requested.}

\item{nu}{Number of left singular vectors to compute (must equal \code{k} for IterableMatrix).}

\item{nv}{Number of right singular vectors to compute (must equal \code{k} for IterableMatrix).}

\item{opts}{Control parameters related to the computing algorithm (see Details).}

\item{threads}{Threads to use for matrix-vector products (BPCells specific).}

\item{...}{Additional arguments passed to \code{RSpectra::svds()} when running on non-BPCells matrices.}
}
\value{
A list with components \code{d}, \code{u}, \code{v}, \code{nconv}, \code{niter}, and \code{nops}.
}
\description{
Use the C++ Spectra solver (same as RSpectra package) to compute the largest
\code{k} singular values and corresponding singular vectors. Empirically, memory
use is much lower than \code{irlba::irlba()} because the solver runs entirely in C++.
}
\details{
When RSpectra is installed, this adds a method to \code{RSpectra::svds()} for
\code{IterableMatrix} objects; otherwise it falls back to the bundled implementation.

The \code{opts} list may include:
\itemize{
\item \code{ncv}: Number of Lanczos basis vectors (\verb{k < ncv <= min(m, n)}). Default \code{min(p, max(2*k+1, 20))}.
\item \code{tol}: Precision parameter (default \code{1e-10}).
\item \code{maxitr}: Maximum iterations (default \code{1000}).
\item \code{center}, \code{scale}: Centering/scaling options (ignored for BPCells).
}
}
\examples{
mat <- matrix(rnorm(500), nrow = 50, ncol = 10)
rownames(mat) <- paste0("gene", seq_len(50))
colnames(mat) <- paste0("cell", seq_len(10))
mat <- mat \%>\% as("dgCMatrix") \%>\% as("IterableMatrix")

svd_res <- svds(mat, k = 5)
names(svd_res)
svd_res$d
dim(svd_res$u)
dim(svd_res$v)

# Can also pass values directly into RSpectra::svds
svd_res <- svds(mat, k = 5, opts = c(maxitr = 500))

}
\references{
Qiu Y, Mei J (2022). RSpectra: Solvers for Large-Scale Eigenvalue and SVD Problems. R package version 0.16-1.
}

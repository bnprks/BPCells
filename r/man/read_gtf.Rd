% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/genomeAnnotations.R
\name{read_gtf}
\alias{read_gtf}
\alias{read_gencode_genes}
\alias{read_gencode_transcripts}
\title{Read GTF gene annotations}
\usage{
read_gtf(
  path,
  attributes = c("gene_id"),
  tags = character(0),
  features = c("gene"),
  keep_attribute_column = FALSE,
  backup_url = NULL,
  timeout = 300
)

read_gencode_genes(
  dir,
  release = "latest",
  annotation_set = c("basic", "comprehensive"),
  gene_type = "lncRNA|protein_coding|IG_.*_gene|TR_.*_gene",
  attributes = c("gene_id", "gene_type", "gene_name"),
  tags = character(0),
  features = c("gene"),
  timeout = 300
)

read_gencode_transcripts(
  dir,
  release = "latest",
  transcript_choice = c("MANE_Select", "Ensembl_Canonical", "all"),
  annotation_set = c("basic", "comprehensive"),
  gene_type = "lncRNA|protein_coding|IG_.*_gene|TR_.*_gene",
  attributes = c("gene_id", "gene_type", "gene_name", "transcript_id"),
  features = c("transcript", "exon"),
  timeout = 300
)
}
\arguments{
\item{path}{Path to file (or desired save location if backup_url is used)}

\item{attributes}{Vector of GTF attribute names to parse out as columns}

\item{tags}{Vector of tags to parse out as boolean presence/absence}

\item{features}{List of features types to keep from the GTF (e.g. gene, transcript, exon, intron)}

\item{keep_attribute_column}{Boolean for whether to preserve the raw attribute text column}

\item{backup_url}{If path does not exist, provides a URL to download the gtf from}

\item{timeout}{Maximum time in seconds to wait for download from backup_url}

\item{dir}{Output directory to cache the downloaded gtf file}

\item{release}{release version (prefix with M for mouse versions). For
most recent version, use "latest" or "latest_mouse"}

\item{annotation_set}{Either "basic" or "comprehensive" annotation sets (see details section).}

\item{gene_type}{Regular expression with which gene types to keep.
Defaults to protein_coding, lncRNA, and IG/TR genes}

\item{transcript_choice}{Method for selecting representative transcripts. Choices are:
\itemize{
\item MANE_Select: human-only, most conservative
\item Ensembl_Canonical: human+mouse, superset of MANE_Select for human
\item all: Preserve all transcript models (not recommended for plotting)
}}
}
\value{
Data frame with coordinates using the 0-based convention. Columns are:
\itemize{
\item chr
\item source
\item feature
\item start
\item end
\item score
\item strand
\item frame
\item attributes (optional; named according to listed attributes)
\item tags (named according to listed tags)
}
}
\description{
Read gene annotations from gtf format into a data frame. The source can be
a URL, a gtf file on disk, or a gencode release version.
}
\details{
\strong{read_gtf}

Read gtf from a file or URL

\strong{read_gencode_genes}

Read gene annotations directly from GENCODE. The file name will vary depending
on the release and annotation set requested, but will be of the format
\code{gencode.v42.annotation.gtf.gz}. GENCODE currently recommends the basic set:
\url{https://www.gencodegenes.org/human/}. In release 42, both the comprehensive and
basic sets had identical gene-level annotations, but the comprehensive set had
additional transcript variants annotated.

\strong{read_gencode_transcripts}

Read transcript models from GENCODE, for use with trackplot_gene()
}
\examples{
#######################################################################
## read_gtf() example
#######################################################################
species <- "Saccharomyces_cerevisiae"
version <- "GCF_000146045.2_R64"
head(read_gtf(
 path = sprintf("./reference/\%s_genomic.gtf.gz", version),
 backup_url = sprintf(
   "https://ftp.ncbi.nlm.nih.gov/genomes/refseq/fungi/\%s/reference/\%s/\%s_genomic.gtf.gz",
   species, version, version
 )
))


#######################################################################
## read_gencode_genes() example
#######################################################################
read_gencode_genes("./references", release = "42")


#######################################################################
## read_gencode_transcripts() example
#######################################################################
## If read_gencode_genes() was already ran on the same release, 
## will reuse previously downloaded annotations
read_gencode_transcripts("./references", release = "42")


}
\seealso{
\code{\link[=read_bed]{read_bed()}}, \code{\link[=read_encode_blacklist]{read_encode_blacklist()}}
}

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate matrix stats — matrix_stats • BPCells</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Calculate matrix stats — matrix_stats"><meta name="description" content="Calculate matrix stats"><meta property="og:description" content="Calculate matrix stats"><script defer data-domain="benparks.net" src="https://plausible.benparks.net/js/visit-counts.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.15/dist/katex.min.css" integrity="sha384-Htz9HMhiwV8GuQ28Xr9pEs1B4qJiYu/nYLLwlDklR53QibDfmQzi7rYxXhMH/5/u" crossorigin="anonymous"><!-- The loading of KaTeX is deferred to speed up page rendering --><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.15/dist/katex.min.js" integrity="sha384-bxmi2jLGCvnsEqMuYLKE/KsVCxV3PqmKeK6Y6+lmNXBry6+luFkEOsmp5vD9I/7+" crossorigin="anonymous"></script><!-- To automatically render math in text elements, include the auto-render extension: --><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.15/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BPCells</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pbmc3k.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pbmc3k.html">Basic tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/benchmarks.html">Performance Benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/how-it-works.html">How BPCells works</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/programming-efficiency.html">Efficiency tips</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="nav-link" href="../python/index.html"><span class="fa fa-arrow-up-right-from-square"></span> Python Docs</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bnprks/BPCells" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate matrix stats</h1>
      <small class="dont-index">Source: <a href="https://github.com/bnprks/BPCells/tree/main/r/R/matrix.R" class="external-link"><code>R/matrix.R</code></a></small>
      <div class="d-none name"><code>matrix_stats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate matrix stats</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">matrix_stats</span><span class="op">(</span></span>
<span>  <span class="va">matrix</span>,</span>
<span>  row_stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"nonzero"</span>, <span class="st">"mean"</span>, <span class="st">"variance"</span><span class="op">)</span>,</span>
<span>  col_stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"nonzero"</span>, <span class="st">"mean"</span>, <span class="st">"variance"</span><span class="op">)</span>,</span>
<span>  threads <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-matrix">matrix<a class="anchor" aria-label="anchor" href="#arg-matrix"></a></dt>
<dd><p>Input matrix object</p></dd>


<dt id="arg-row-stats">row_stats<a class="anchor" aria-label="anchor" href="#arg-row-stats"></a></dt>
<dd><p>Which row statistics to compute</p></dd>


<dt id="arg-col-stats">col_stats<a class="anchor" aria-label="anchor" href="#arg-col-stats"></a></dt>
<dd><p>Which col statistics to compute</p></dd>


<dt id="arg-threads">threads<a class="anchor" aria-label="anchor" href="#arg-threads"></a></dt>
<dd><p>Number of threads to use during execution</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List of row_stats: matrix of n_stats x n_rows,
col_stats: matrix of n_stats x n_cols</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The statistics will be calculated in a single pass over the matrix,
so this method is desirable to use for efficiency purposes compared to
the more standard rowMeans or colMeans if multiple statistics are needed.
The stats are ordered by complexity: nonzero, mean, then variance. All
less complex stats are calculated in the process of calculating a more complicated stat.
So to calculate mean and variance simultaneously, just ask for variance,
which will compute mean and nonzero counts as a side-effect</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cell"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="va">mat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="st">"dgCMatrix"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="st">"IterableMatrix"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## By default, no row or column stats are calculated</span></span></span>
<span class="r-in"><span><span class="va">res_none</span> <span class="op">&lt;-</span> <span class="fu">matrix_stats</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res_none</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $row_stats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      gene1 gene2 gene3 gene4 gene5 gene6 gene7 gene8 gene9 gene10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $col_stats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      cell1 cell2 cell3 cell4 cell5 cell6 cell7 cell8 cell9 cell10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Request row variance (automatically computes mean and nonzero too)</span></span></span>
<span class="r-in"><span><span class="va">res_row_var</span> <span class="op">&lt;-</span> <span class="fu">matrix_stats</span><span class="op">(</span><span class="va">mat</span>, row_stats <span class="op">=</span> <span class="st">"variance"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res_row_var</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $row_stats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              gene1     gene2     gene3     gene4     gene5 gene6    gene7 gene8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nonzero  10.000000 10.000000 10.000000 10.000000 10.000000  10.0 10.00000  10.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean      7.000000  4.200000  3.500000  4.800000  5.800000   5.4  4.90000   4.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variance  5.555556  3.288889  3.388889  5.288889  5.511111   1.6 10.54444   2.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              gene9    gene10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nonzero  10.000000 10.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean      5.700000  6.300000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variance  6.677778  4.011111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $col_stats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      cell1 cell2 cell3 cell4 cell5 cell6 cell7 cell8 cell9 cell10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Request both row variance and column variance</span></span></span>
<span class="r-in"><span><span class="va">res_both_var</span> <span class="op">&lt;-</span> <span class="fu">matrix_stats</span><span class="op">(</span></span></span>
<span class="r-in"><span>  mat <span class="op">=</span> <span class="va">mat</span>,</span></span>
<span class="r-in"><span>  row_stats <span class="op">=</span> <span class="st">"variance"</span>,</span></span>
<span class="r-in"><span>  col_stats <span class="op">=</span> <span class="st">"mean"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res_both_var</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $row_stats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              gene1     gene2     gene3     gene4     gene5 gene6    gene7 gene8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nonzero  10.000000 10.000000 10.000000 10.000000 10.000000  10.0 10.00000  10.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean      7.000000  4.200000  3.500000  4.800000  5.800000   5.4  4.90000   4.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variance  5.555556  3.288889  3.388889  5.288889  5.511111   1.6 10.54444   2.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              gene9    gene10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nonzero  10.000000 10.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean      5.700000  6.300000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variance  6.677778  4.011111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $col_stats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         cell1 cell2 cell3 cell4 cell5 cell6 cell7 cell8 cell9 cell10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nonzero  10.0  10.0  10.0  10.0  10.0  10.0  10.0  10.0    10     10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean      4.6   5.4   5.3   4.5   5.4   5.7   5.3   5.1     6      5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Created by Benjamin Parks.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>



  <img src="https://plausible.benparks.net/flask-plausible/bpcells-docs.png" style="position:absolute;"></body></html>

